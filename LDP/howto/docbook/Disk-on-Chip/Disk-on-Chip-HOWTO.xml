<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.2//EN"
"http://www.oasis-open.org/docbook/xml/4.2/docbookx.dtd"
[
]>
<article id="index">
<articleinfo>
<title>Booting Linux from DiskOnChip HOWTO</title>

<author>
	<firstname>Rohit</firstname>
	<surname>Agarwal</surname>
	<affiliation>
	<address>
        <email><ulink url="mailto:rohdimp_24@rediffmail.com">rohdimp_24@rediffmail.com</ulink></email>
     </address>
	</affiliation>
</author>
<author>
	<firstname>Vishnu</firstname>
	<surname>Swaminathan</surname>
	<affiliation>
	<address>
     <email><ulink url="mailto:vishnu.swaminathan@siemens.com">Vishnu.Swaminathan@siemens.com</ulink></email>
     </address>
	</affiliation>

</author>
<pubdate>20060907</pubdate>

<abstract>
<para>This document discusses how to make the Flash Drives Linux bootable.  We will describe how to boot from such a drive, instead of from the normal hard drive.</para>
</abstract>

<revhistory>
	<revision>
		<revnumber>1.0</revnumber>
		<date>2006-09-07</date>
		<authorinitials>MG</authorinitials>
		<revremark>Last review for LDP publication</revremark>
	</revision>
</revhistory>

</articleinfo>

<sect1 id="intro"><title>Introduction</title>
<sect2 id="why"><title>Why this document?</title>
<para>DiskOnChip (DOC) is a flash drive that is manufactured by M-Systems. The use of flash drives is emerging as a substitute for Hard Disks in embedded devices. Embedded Linux is gaining popularity as the operating system of choice in the embedded systems community; as such, there is an increased demand for embedded systems that can boot into Linux from flash drives.</para>
<para>Much of the documentation currently available on the subject is either incorrect or incomplete; the presentation of the information which is provided by such documents is likely to confuse novice users.</para> 
</sect2>
<sect2 id="NFTL"><title>NFTL vs. INFTL</title>
<para>Another fundamental problem is that most of the documents assume the DiskOnChip to be a NFTL (NAND Flash Translation Layer) device, and proceed to describe the booting process for NFTL devices. DiskOnChip architectures come in two variants, each of which requires different booting procedures: NFTL and INFTL (Inverse NFTL). Dan Brown, who has written a boot loader known as DOCBoot, explains the differences between these variants in a README document, which is included with the DOCBoot package: <ulink url="http://ftp.arm.linux.org.uk/pub/people/dwmw2/mtd/cvs/mtd/docboot/" />.</para>
<para>An INFTL device is organized as follows:</para>
<blockquote>
<para>IPL</para>
<para>Media Header</para>
<para>Partition 0 (BDK or BDTL)</para>
<para>(Optional) Partition 1(BDK or BDTL)</para>
<para>.. Up to at most Partition 3</para>
</blockquote>

<para>Under Linux MTD partitions are created for each partition listed in the INFTL partition table. Thus up to 5 MTD devices are created.</para>

<para>By contrast the NFTL device is organized as follows:</para>
<blockquote>
<para>Firmware</para>
<para>Media Header</para>
<para>BDTL Data</para>
</blockquote>

<para>Under Linux, normally two MTD devices will be created.</para>

<para>According to the above excerpt, the process used by the boot loader when fetching the kernel image for an INFTL device is different from the method used for NFTL devices, since both devices have different physical layouts. (repetitive)</para>
<para>Using a 2.4.x kernel  for an INFTL DiskOnChip device is complicated by the lack of native support in pre-2.6.x kernels (although native NFTL support is present). Such functionality is only available by <emphasis>patching</emphasis> the kernel; an approach which is ill-advised.</para>
<para>Patching the kernel with external INFTL support is discouraged; the developers of the MTD driver, the open source driver available for DiskOnChip, are apprehensive of this approach as well. For more information on this matter, feel free to peruse the mailing list conversation on the subject at <ulink url="http://lists.infradead.org/pipermail/linux-mtd/2004-August/010165.html" />.</para>
<para>The drivers that provide native INFTL support in the 2.6.x kernels failed to identify the DiskonChip device used for this exercise, and the following message was reported by the system:</para>
<screen>
INFTL no longer supports the old DiskOnChip drivers loaded via docprobe.  
Please use the new diskonchip driver under the NAND subsystem.
</screen>
<para>So then we decided to use the drivers provided by M-Systems (manufacturer of DiskOnChip).  However, according to the documentation provided by the vendor on these drivers, they were designed for NFTL devices only. As such, we decided to write this HOWTO which will address the use of INFTL devices. We have taken special care to remove any ambiguity in the steps and also tried to give reasons for the need of a particular step so as to make things logically clear. We have explained things in such a way that a person with less experience on Linux can also follow the steps.</para>
</sect2>
<sect2 id="aims"><title>Practical goals</title>
<para>This document aims to act as a guide to:</para>
<itemizedlist>
<listitem><para>Use M-Systems DiskOnChip 2000 TSOP as an additional storage drive along with an IDE HDD running Linux on it.</para></listitem>
<listitem><para>Install Linux on DiskOnChip 2000 TSOP and boot Linux from it.</para></listitem>
<listitem><para>Install the Development Tool-Chain so as to compile and execute programs directly on DiskOnChip.</para></listitem>
</itemizedlist>

<para>The method described here has been tested for DiskOnChip 2000 TSOP 256MB and DiskOnChip 2000 TSOP 384MB.</para>
</sect2>      
</sect1>
<sect1 id="refconf"><title>Reference configuration</title>
<para>We used the following hard- and software:</para>
<orderedlist>
<listitem><para>VIA Eden CPU 1GHz clock speed 256MB RAM</para></listitem>
<listitem><para>RTD Enhanced Phoenix - AwardBIOS CMOS Setup Utility (v6.00.04.1601)</para></listitem>
<listitem><para>Kernel 2.4.18 source code downloaded from <ulink url="www.kernel.org/pub/linux/kernel/v2.4" /></para></listitem>
<listitem><para>256 MB M-Systems DiskOnChip 2000 TSOP (MD2202-D256)</para></listitem>
<listitem><para>M-Systems TrueFFS Linux driver version 5.1.4 from <ulink url="http://www.m-sys.com/site/en-US/Support/SoftwareDownload/Driver+Download.htm?driver=linux_binary.5_1_4.tgz" /></para></listitem>
<listitem><para>LILO version 22.3.2 (distributed with driver)</para></listitem>
<listitem><para>DiskOnChip DOS utilities version 5.1.4 and BIOS driver version 5.1.4 from <ulink url="http://www.m-sys.com/site/en-US/Support/SoftwareDownload/TrueFFS5.x/BIOSDOSdriverandtools.htm" /></para></listitem>
<listitem><para>Dual bootable Hard Disk with Knoppix 3.9 and Windows XP using Grub 0.96 as the Boot Loader</para></listitem>
<listitem><para>GNU GCC-2.95.3</para></listitem>
<listitem><para>Latest root_fs_i386 image from <ulink url="http://www.uclibc.org/downloads/root_fs_i386.ext2.bz2" /> or <ulink url="http://www.uclibc.org/downloads/root_fs_i386.ext2.tar.gz" /></para></listitem>
</orderedlist>
</sect1>
<sect1 id="assumptions"><title>Assumptions</title>
<para>We have made some assumptions related to working directories and mounting points which we would like to mention before listing the entire procedure for putting Linux on DiskOnChip.</para>
<itemizedlist>
<listitem><para>We will perform all the compilation in <filename>/usr/src</filename> of the host machine so downloading of the necessary files must be done into that directory.</para></listitem>
<listitem><para>All the commands listed are executed assuming <filename>/usr/src</filename> as the present working directory.</para></listitem>
<listitem><para>We will mount the DiskOnChip partition on <filename>/mnt/doc</filename>.</para></listitem>
<listitem><para>The names of the directories will be exactly the same as the files that  have been downloaded so the document will give the actual path as were created on the host system.</para></listitem>
<listitem><para>DiskOnChip and DOC have been used interchangeably to mean M-Systems DiskOnChip 2000 TSOP.</para></listitem>
<listitem><para>The DOS utilities have been downloaded and saved in a Windows partition directory.</para></listitem>
</itemizedlist>

</sect1>
<sect1 id="steps"><title>Using M-Systems DiskOnChip 2000 TSOP as an additional storage drive in Linux</title>
<para>The following are the steps performed for this purpose.</para>
<sect2 id="step1"><title>Step 1: Patch the Kernel</title>
<para>Download a fresh copy of Kernel 2.4.18 from <ulink url="http://www.kernel.org/pub/linux/kernel/v2.4" />.</para>
<para>The kernel that is downloaded from the site does not have support for the M-Systems driver so we need to add this functionality.  This is done by adding a patch to the kernel.</para>
<para>The steps to conduct patching are as follows:</para>
<orderedlist>
<listitem><para>Untar the kernel source file and the M-systems TrueFFS Linux driver version 5.14.  If the source code is in <filename>.tar.gz</filename> format, use</para>
<cmdsynopsis><command>tar <option>-xvzf</option> <filename>linux-2.4.18.tar.gz</filename></command></cmdsynopsis>
<para>If the source code is in <filename>.tar.bz2</filename> format, use</para>
<cmdsynopsis><command>bunzip2 <filename>linux-2.4.18.tar.bz2</filename></command></cmdsynopsis>
<para>After using <command>bunzip2</command>, you will get a file named <filename>linux-2.4.18.tar</filename>.  Untar it using the command</para>
<cmdsynopsis><command>tar <option>-xvf</option> <filename>linux-2.4.18.tar</filename></command></cmdsynopsis>
<para>Unarchiving the driver is done using the command</para>
<cmdsynopsis><command>tar <option>-xvzf</option> <filename>linux_binary.5_1_4.tgz</filename></command></cmdsynopsis>
<para>This results in the creation of two directories: <filename>linux</filename> and <filename>linux_binary.5_1_4</filename>.</para>
</listitem>
<listitem><para>The TrueFFS Linux driver package contains three different folders:</para>
<itemizedlist>
<listitem><para><filename>Documentation</filename>: this contains a PDF document describing the various functions of TrueFFS.</para></listitem>
<listitem><para><filename>dformat_5_1_4_37</filename>: this contains a utility <command>dformat</command>, which is used to update the firmware on the DiskOnChip (DOC) and to create low level partitions on the DOC.</para></listitem>
<listitem><para><filename>doc-linux-5_1_4_20</filename>: this contains patches, <filename>initrd</filename> scripts and other utilities.</para></listitem>
</itemizedlist>
</listitem>
<listitem><para>Now apply the patch to the kernel.  We will use the <filename>linux-2_4_7-patch</filename> file that is present in <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/driver</filename>.  The following commands are used for this purpose:</para>
<cmdsynopsis><command>cd <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/driver</filename></command></cmdsynopsis>
<cmdsynopsis><command>patch <option>-p1 -d</option> <filename>/usr/src/linux</filename> &lt; <filename>linux-2_4_7-patch</filename></command></cmdsynopsis>
<para>This will create a directory named <filename>doc</filename> in the <filename>linux/drivers/block</filename> directory.</para>
</listitem>
<listitem><para>The patch created the <filename>doc</filename> directory, but did not copy the source files of the M-Systems driver, which are necessary in order to build the driver, into this directory.  So execute the following command:</para>
<cmdsynopsis><command>cp <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/driver/doc/* /usr/src/linux/drivers/block/doc</filename></command></cmdsynopsis>
</listitem>
</orderedlist>

<warning><title>Kernel version</title>
<para>The patch will fail for kernels other than 2.4.18 since the source files where the patch is to be applied may be somewhat different in different kernels. The patch has been provided specifically for kernel 2.4.18.</para>
</warning>

<para>Before moving on to Step 2, do the following:</para>
<itemizedlist>
<listitem><para>Login as root.</para></listitem>
<listitem><para>Make sure that <command>gcc</command> version is 2.95.3 else the build will fail. Use <command>gcc <option>--version</option></command> to check this.  If your <command>gcc</command> version is different compile gcc-2.95.3. Refer to <ulink url="http://xlife.zuarvra.net.columns/20020316" /> for this purpose.</para></listitem>
</itemizedlist>
</sect2>

<sect2 id="step2"><title>Step 2: Compile the Kernel</title>
<para>Complete the following tasks for compiling the kernel:</para>
<orderedlist>
<listitem><para><command>cd <filename>linux</filename></command></para></listitem>
<listitem><para><command>make <parameter>menuconfig</parameter></command></para>
<para>Check for the following options:</para>
<itemizedlist>
<listitem><para>In the <quote>Block devices menu</quote>, select:</para>
	<itemizedlist>
	<listitem><para>M-Systems driver as module i.e. (M)</para></listitem>
	<listitem><para>Loopback device support as built-in i.e. (*)</para></listitem>
	<listitem><para>RAM disk support as built-in i.e. (*)</para></listitem>
	<listitem><para>Initial RAM disk (initrd) support as built .in i.e. (*)</para></listitem>
	</itemizedlist>
</listitem>
<listitem><para>In the <quote>Processor type and features menu</quote>, select <quote>Disable Symmetric Multiprocessor Support</quote>.</para></listitem>
<listitem><para>In the <quote>filesystem menu</quote>, select:</para>
	<itemizedlist>
	<listitem><para>Ext3 journaling file system support as built-in</para></listitem>
	<listitem><para>DOS FAT fs support as built-in<superscript>a</superscript></para></listitem>
	<listitem><para>MSDOS fs support as built-in<superscript>b</superscript></para></listitem>
	<listitem><para>VFAT (Windows-95) fs support as built-in<superscript>c</superscript> </para></listitem>
	</itemizedlist>
</listitem>
</itemizedlist>
<note><title>File System Menu</title>
<para>a,b,c options should be activated if you want to mount your MS Windows partition, else they can be left out.  It is, however, generally recommended to use them.</para>
</note>

<para>An excellent resource on kernel compilation is the <ulink url="http://www.digitalhermit.com/linux/Kernel-Build-HOWTO.html">Kernel Rebuild Guide</ulink>.</para>
<para>The configuration file, <filename>linux/.config</filename> should essentially contain the following lines (only a part of the config file has been given):</para>
<screen>
#
# Loadable module support
#
CONFIG_MODULES=y
CONFIG_MODVERSIONS=y
CONFIG_KMOD=y

#
# Processor type and features
#

# CONFIG_SMP is not set


#
# Memory Technology Devices (MTD)
#
# CONFIG_MTD is not set

#
# Block devices
#
# CONFIG_BLK_DEV_FD is not set
# CONFIG_BLK_DEV_XD is not set
# CONFIG_PARIDE is not set
# CONFIG_BLK_CPQ_DA is not set
# CONFIG_BLK_CPQ_CISS_DA is not set
# CONFIG_BLK_DEV_DAC960 is not set
CONFIG_BLK_DEV_LOOP=y
# CONFIG_BLK_DEV_NBD is not set
CONFIG_BLK_DEV_RAM=y
CONFIG_BLK_DEV_RAM_SIZE=4096
CONFIG_BLK_DEV_INITRD=y
CONFIG_BLK_DEV_MSYS_DOC=m

#
# File systems
#
# CONFIG_QUOTA is not set
# CONFIG_AUTOFS_FS is not set
# CONFIG_AUTOFS4_FS is not set
CONFIG_EXT3_FS=y
CONFIG_FAT_FS=y
CONFIG_MSDOS_FS=y
# CONFIG_UMSDOS_FS is not set
CONFIG_VFAT_FS=y
# CONFIG_EFS_FS is not set
# CONFIG_JFFS_FS is not set
# CONFIG_JFFS2_FS is not set
# CONFIG_CRAMFS is not set
CONFIG_TMPFS=y
# CONFIG_RAMFS is not set
CONFIG_ISO9660_FS=y
# CONFIG_JOLIET is not set
# CONFIG_HPFS_FS is not set
CONFIG_PROC_FS=y
# CONFIG_DEVFS_FS is not set
# CONFIG_DEVFS_MOUNT is not set
# CONFIG_DEVFS_DEBUG is not set
CONFIG_DEVPTS_FS=y
# CONFIG_QNX4FS_FS is not set
# CONFIG_QNX4FS_RW is not set
# CONFIG_ROMFS_FS is not set
CONFIG_EXT2_FS=y
</screen>

</listitem>
<listitem><para><command>make <parameter>dep</parameter></command></para></listitem>
<listitem><para><command>make <parameter>bzImage</parameter></command></para></listitem>
<listitem><para><command>make <parameter>modules</parameter></command></para></listitem>
<listitem><para><command>make <parameter>modules_install</parameter></command></para></listitem>
<listitem><para>Copy the newly created <filename>bzImage</filename> to the <filename>/bott</filename> directory and name it <filename>vmlinuz-2.4.18</filename>, using this command:</para>
<cmdsynopsis><command>cp <filename>/arch/i386/boot/bzImage /boot/vmlinuz-2.4.18</filename></command></cmdsynopsis>
</listitem>
</orderedlist>
<para>Check for <filename>lib/modules/2.4.18/kernel/drivers/block/doc.o</filename>.  This is the M-Systems driver that we need to access DiskOnChip.</para>
</sect2>
<sect2 id="step3"><title>Step 3: Create Nodes</title>
<para>Now we will create block devices, which are required to access the DOC
These block devices will use the M-Systems driver that was built in <xref linkend="step2" /> to access the DOC. The script <command>mknod_fl</command> in <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/driver</filename> is used for this purpose.</para>
<para>We need to create the block devices with the major number of 62. For this purpose we will pass the argument 62 while creating the nodes:</para>
<cmdsynopsis><command>./mknod_fl <parameter>62</parameter></command></cmdsynopsis>
<para>This will create the following devices in <filename>/dev/msys</filename> with major number 62:</para>
<screen>
fla...fla4
flb...flb4
flc...flc4
fld...fld4
</screen>
</sect2>
<sect2 id="step4"><title>Step 4: Reboot with the new kernel</title>
<para>In order to have the DiskOnChip recognized by Linux OS, we need to insert the DOC driver module into the kernel. Since the currently running kernel doesn.t have support for the M-Systems Driver, we need to boot into new kernel we just compiled in <xref linkend="sect2" />.</para>
<para>For this purpose we need to add the following entries in the <filename>/boot/grub/menu.lst</filename> file:</para>
<screen>
title Debian GNU/Linux,Kernel 2.4.18
root (hd0,7)
kernel /boot/vmlinuz-2.4.18 root=/dev/hda8
safedefault
boot
</screen>
<para>Where (hd0,7) is the partition holding the kernel image <filename>vmlinuz-2.4.18</filename> and <filename>/dev/hda8</filename> is the partition holding the <emphasis>root filesystem</emphasis>.  These partitions may vary from one system to another. Now reboot and choose the kernel 2.4.18 option (the kernel that has been compiled in Step 2) in the <command>grub</command> menu to boot into the new kernel.</para>
</sect2>
<sect2 id="step5"><title>Step 5: Insert M-Systems Driver/Module in the new Kernel</title>
<para>The M-Systems driver by default gets loaded with major number 100, but our newly created nodes (see <xref linkend="step3" />) have a major number 62. Therefore we need to insert this module with a major number 62. This can be done in either of two ways:</para>
<orderedlist>
<listitem><para>While inserting the module using <command>insmod</command> also mention the major number for the module which needs to be assigned to it otherwise it will take the default major number of 100:</para>
<cmdsynopsis><command>insmod <parameter>doc major=62</parameter></command></cmdsynopsis>
</listitem>
<listitem><para>Add the following line to <filename>/etc/modules.conf</filename>:</para>
<screen>options doc major=62</screen>
<para>Then use <command>modprobe <parameter>doc</parameter></command> to insert the modules.</para>
</listitem>
</orderedlist>
		            
<para>Check for the correct loading of the module using the <command>lsmod</command> command without options.</para>
</sect2>
<sect2 id="step6"><title>Step 6: Create a filesystem on the DiskOnChip</title>
<para>Before we can start using DiskOnChip we need to create a filesystem on it.  We will create an ext2 filesystem since it is small in size.</para>
<para>This involves a hidden step of making partitions on the DOC using <command>fdisk</command>.  The actual steps are as follows:</para>
<orderedlist>
<listitem><cmdsynopsis><command>fdisk <filename>/dev/msys/fla</filename></command></cmdsynopsis>
<para>This command will ask to create partitions.  Create a primary partition number 1 with start cylinder as 1 and final cylinder as 1002.</para>
<para>Check the partition table, which should look like this:</para>
<screen>
Device             Boot  Start      End        Blocks    ID     System
/dev/msys/fla1            1         1002        255984   83     Linux
</screen>
</listitem>
<listitem><para>Make the filesystem on <filename>/dev/msys/fla1</filename> with the command</para>
<cmdsynopsis><command>mke2fs <option>-c</option> <filename>/dev/msys/fla1</filename></command></cmdsynopsis>
<para>Where <filename>fla1</filename> is the first primary partition on the DOC. (We have created only one partition in order to avoid unnecessary complexity.)</para>
</listitem>
</orderedlist>
</sect2>
<sect2 id="step7"><title>Step 7: Mount the newly created partition to start accessing DOC</title>
<para>Create a new mount point for the DiskOnChip in the <filename>/mnt</filename> directory:</para>
<cmdsynopsis><command>mkdir <filename>/mnt/doc</filename></command></cmdsynopsis>
<para>Mount the DOC partition on the newly created directory:</para>
<cmdsynopsis><command>mount <option>-t</option> <parameter>auto</parameter> <filename>/dev/msys/fla1 /mnt/doc</filename></command></cmdsynopsis>
<para>You will now be able to read and write to the DOC as an additional storage drive.</para>
<para>When you reboot your system, make the DOC available by inserting the driver into the kernel (see <xref linkend="step5" />) and mounting the device.</para>
</sect2>
</sect1>
<sect1 id="install"><title>Install Linux and LILO on DiskOnChip</title>
<para>In this section we will learn how to install Linux operating system on an unformatted DOC and boot from it using LILO as the boot loader.</para>
<para>In order to get to this state, a procedure will be discussed.  Some steps in this procedure resemble the steps discussed previously in this document.  Even so, this should be considered a separate procedure, rather than a continuation of the steps in <xref linkend="steps" />.</para>
<para>In general, to make a device to boot into Linux, it should have the following components:</para>
<itemizedlist>
<listitem><para>Kernel Image</para></listitem>
<listitem><para>Root Filesystem</para></listitem>
<listitem><para>Boot loader to load the kernel Image into memory</para></listitem>
</itemizedlist>

<para>This section will basically try to fulfill the above three requirements.</para>
<para>The following steps should be followed for achieving the goal of this section.</para>
<sect2 id="copy_firmware"><title>Step 1: Copying the DOC firmware onto DiskOnChip</title>
<para>We will use the <command>dformat</command> utility from <filename>linux_binary.5_1_4/dformat_5_1_4_37</filename>.</para>
<para>M-Systems does not provide the firmware for using the DOC on Linux platforms. We address this problem by making a copy of the firmware shipped with the M-Systems dos utilities into this directory (<quote>dos utilities</quote> is the term used by the M-Systems people so we have also used this name).  On our system we copied it by mounting the windows partition and extracting it from there:</para>
<cmdsynopsis><command>mount <option>-t</option> <parameter>auto</parameter><filename>/dev/hda5 /mnt/d</filename></command></cmdsynopsis>
<cmdsynopsis><command>cp <filename>/mnt/d/dos\ utilities/doc514.exb linux_binary.5_1_4/dformat_5_1_4_37/</filename></command></cmdsynopsis>
<para>Now format the drive, using the <command>dtformat</command> from <filename>linux_binary.5_1_4/dformat_5_1_4_37/</filename>:</para>
<cmdsynopsis><command>cd <filename>linux_binary.5_1_4/dformat_5_1_4_37/</filename></command></cmdsynopsis>
<cmdsynopsis><command>./dformat <option>-WIN:D000 -S:doc514.exb</option></command></cmdsynopsis>
<para><parameter>D000</parameter> specifies the address of the DiskOnChip in the BIOS.</para>
<para>The following is the BIOS (RTD Enhanced Phoenix - AwardBIOS CMOS Setup Utility (v6.00.04.1601)) setting on our system.</para>
<para>The Integrated peripherals of the BIOS menu should have:</para>
<screen>
SSD Socket #1 to Bios Extension
Bios Ext. Window size 8k
Bios Ext. window [D000:0000]
Fail safe Boot ROM [Disabled]
</screen>
<para>The Bios Ext. Window denotes the address for your DiskOnChip.</para>
<note><title>BIOSes</title>
<para>The setting may be different depending upon your BIOS version.</para>
</note>
<para>Now shutdown the system and boot into Windows XP.</para>
<para>From now on you will notice the TrueFFS message and some time delay before the Grub Menu appears.</para>
</sect2>
<sect2 id="format"><title>Step 2: Format DiskOnChip using Dos Utilities</title>
<para>Boot into Windows XP. We will use the M-Systems Dos Utilities for formatting the DiskOnChip. The Dos utility <command>dformat</command> will copy the firmware to the DOC, and then format it as a <emphasis>fat16</emphasis> device.</para>
<para>Using the command prompt, run the following command from the DOS utilities folder (assuming that you have already downloaded the DOS utilities):</para>
<cmdsynopsis><command>dformat <option>/WIN:D000 /S:doc514.exb</option></command></cmdsynopsis>
<para>Check the DOC partition using another utility called <command>dinfo</command>. A sample <command>dinfo</command> output is given in the appendix.</para>
<para>Again shutdown the system and now boot into Linux.</para>

<note><title>Always shutdown</title>
<para>After formatting you should always do a full shutdown (power off) and not just a reboot.</para>
</note>
<para>Even though Step 1 and Step 2 seem to be the same, the only difference being that Step 1 is done from Linux and Step 2 from Windows XP, they both have to be done.</para>
<!--FIXME: reason being?-->
</sect2>
<sect2 id="patch+compile"><title>Step 3: Patch and Compile the kernel 2.4.18</title>
<para>This has to be performed in exactly the same manner as described in <xref linkend="step1" /> and <xref linkend="step2" />.</para>
<para>Also add an entry for the new kernel in <filename>/boot/grub/menu.lst</filename> as described in <xref linkend="step4" />.</para>
</sect2>
<sect2 id="nodes"><title>Step 4: Create nodes</title>
<para>This is done using the ame procedure as described in <xref linkend="step3" />.</para>
</sect2>
<sect2 id="modconf"><title>Step 5: Modify the /etc/module.conf file</title>
<para>The file <filename>/etc/modules.conf</filename> has to be modified, adding this line at the end of the file:</para>
<screen>
options doc major=62
</screen>
<para>This is required since our nodes use a major number of 62, while the doc driver module uses a major number of 100. When creating the <filename>initrd</filename> image, the driver will be loaded with major number value of 100 (instead of 62) if you do not edit the module configuration file.  This will make it impossible for the nodes to use the driver. The reason for using the initrd image will be explained in the next step.</para>

<para>The <command>mkinitrd_doc</command> script from <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/driver</filename> reads the <filename>/etc/modules.conf</filename> file and looks for anything that has been mentioned for the DOC driver regarding the major number. By default, <command>mkinitrd_doc</command> will create an <filename>initrd</filename> image that loads the DOC module with a major number of 100. However, with the modifications we have made to the <filename>/etc/modules.conf</filename> file, the <filename>initrd</filename> image will load the module with a major number of 62.</para>

</sect2>
<sect2 id="initrd"><title>Step 6: Create the initrd image</title>
<para>Run the <command>mkinitrd_doc</command> script from <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/driver/</filename>:</para>
<cmdsynopsis><command>./mkinitrd_doc</command></cmdsynopsis>

<para>This may give warning messages similar to the following, which can be safely ignored:</para>
<screen>
  cp: cannot stat ./sbin/insmod.static.: No such file or directory
  cp: cannot stat ./dev/systty.: No such file or directory
</screen>
<para>Check for the newly created <filename>initrd</filename> image, <filename>initrd-2.4.18.img</filename>, in the <filename>/boot</filename> directory. </para>

<para>Running the <command>mkinitrd_doc</command> script produces this image. The reason for making an <filename>initrd</filename> image is that the provided M-Systems driver cannot be added as a built-in support in the kernel, which leaves no other option than adding it as a loadable module. If we want to boot from DOC, the kernel should know how to access the DOC at the time of booting to search for <command>/sbin/init</command> in the root filesystem on the DOC (the root filesystem is necessary to get the Linux system up).</para>

<para>In the booting sequence of the Linux, <command>/sbin/init</command> is the file (a command actually) that the kernel looks for in order to start various services and, finally, give the login shell to the user.  The figure below illustrates the problem:</para>

   
<figure><title>Why we need an initrd image</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/initrd.png" format="PNG"></imagedata>
</imageobject>
<imageobject>
<imagedata fileref="images/initrd.eps" format="EPS"></imagedata>
</imageobject>
<textobject>
<phrase>Through the initrd image, the kernel kan read /sbin/init on the root system om the DOC.</phrase>
</textobject>
</mediaobject>
</figure>

</sect2>
<sect2 id="insert_driver"><title>Step 7: Insert the DOC driver into the new kernel</title>
<para>Reboot the system and boot into the newly created kernel.</para>
<para>Now insert the doc module:</para>
<cmdsynopsis><command>modprobe <parameter>doc</parameter></command></cmdsynopsis>
<para>This will give the following messages:</para>
<screen>
fl : Flash disk driver for DiskOnChip
fl: DOC devices(s) found: 1
fl: _init:registed device at major 62
.
.
.
.
</screen>

<para>To access the DOC, ensure that the major number assigned to the nodes is 62.</para>
<para>In case of a major number of 100 is assigned, check if the <filename>/etc/modules.conf</filename> was successfully modified. If it was not, then repeat <xref linkend="modconf" />. You must then also repeat <xref linkend="initrd" /> because the <filename>initrd</filename> image depends on <filename>/etc/modules.conf</filename>.   If the DOC entry were incorrect in this file, the <filename>initrd</filename> image will be useless.</para>
</sect2>
<sect2 id="createfs"><title>Step 8:  Create a filesystem on the DiskOnChip</title>
<para>Perform <xref linkend="step6" />.  This is required to create partitions on the DOC.</para>
</sect2>
<sect2 id="rootfs"><title>Step 9:  Build Root Filesystem on the DiskOnChip</title>
<para>Before starting with this step make sure that you have not mounted <filename>/dev/msys/fla1</filename> on any of the mount points, as this step will involve reformatting the DiskOnChip.</para>

<para>Also, in order to understand the details of Root File system refer to <ulink url="http://www.tldp.org/HOWTO/Bootdisk-HOWTO/index.html">The Linux Bootdisk How To</ulink> available at <ulink url="http://www.tldp.org" />.</para>

<para>We will use the <command>mkdocimg</command> script located in <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/build</filename>.</para>
<para>We will also use the <filename>redhat-7.1.files</filename> directory, located in the same directory (i.e. <filename>build</filename>), which contains the list of the files that will be copied in the root filesystem that will be created on the DOC.</para>
<cmdsynopsis><command>./mkdocimg <filename>redhat-7.1.files</filename></command></cmdsynopsis>
<para>This step will take a few minutes to complete.</para>

<para>Now mount the <filename>/dev/msys/fla1</filename> partition on the mount point <filename>/mnt/doc</filename> and check the files that have been created:</para>
<cmdsynopsis><command>mount <option>-t</option> <parameter>auto</parameter> <filename>/dev/msys/fla1 /mnt/doc</filename></command></cmdsynopsis>
<cmdsynopsis><command>cd <filename>/mnt/doc</filename></command></cmdsynopsis>

<para>The following directories are created on the DOC as a result of running the script:</para>
<para><filename>bin dev sbin etc lib usr home mnt tmp var boot</filename></para><para>The most important is the boot directory. This contains the <filename>vmlinuz-2.4.18</filename> and <filename>initrd-2.4.18.img</filename> which gets copied from the <filename>/boot</filename> directory. This directory is required when booting from DiskOnChip.</para>
<para>Apart from these files there are some other files which must be deleted:</para>
<itemizedlist>
<listitem><para><filename>System.map-2.4.18</filename></para></listitem>
<listitem><para><filename>boot.3E00</filename></para></listitem>
</itemizedlist>
<para>These two files are created later by LILO.</para>
<para>The <filename>redhat-7.1.files</filename> directory contains a list of files and directories that will be created when we use the <command>mkdocimg</command> script.</para>


<para>This script does not create all the files that are necessary for creating the root filesystem on the DOC. So replace the directories created by the <command>mkdocimg</command> script, with the directories of the <filename>/</filename> filesystem (root filesystem that is currently running).</para>
<para>The directories under <filename>/</filename>, such as <filename>etc</filename>, <filename>sbin</filename>, <filename>bin</filename> and so on contain lot of files that are not useful and ideally should not be copied while building the root filesystem for DOC. But since we have not discussed the files that are essential and the files that can be removed, we therefore suggest that one should copy the entire contents of the directories. We know that it is a clumsy way of building the root filesystem and will unnecessarily take lot of memory; bear with us as in the next section we will explain how to put the development tools on the DOC.  We will then remove the useless files from the root filesystem of DOC.</para>
<para>If you are aware of how to build the root filesystem we would encourage you to copy only the essential files.</para>

<para>The following is the set of commands we used to modify the root filesystem:</para>
<cmdsynopsis><command>rm <option>-rf</option> <filename>/mnt/doc/sbin</filename></command></cmdsynopsis>
<cmdsynopsis><command>rm <option>-rf</option> <filename>/mnt/doc/etc</filename></command></cmdsynopsis>
<cmdsynopsis><command>rm <option>-rf</option> <filename>/mnt/doc/lib</filename></command></cmdsynopsis>
<cmdsynopsis><command>rm <option>-rf</option> <filename>/mnt/doc/dev</filename></command></cmdsynopsis>

<cmdsynopsis><command>cp <option>-rf</option> <filename>/sbin /mnt/doc</filename></command></cmdsynopsis>
<cmdsynopsis><command>cp <option>-rf</option> <filename>/etc /mnt/doc</filename></command></cmdsynopsis>
<cmdsynopsis><command>cp <option>-rf</option> <filename>/dev /mnt/doc</filename></command></cmdsynopsis>
<cmdsynopsis><command>cp <option>-rf</option> <filename>/lib /mnt/doc</filename></command></cmdsynopsis>
<cmdsynopsis><command>rm <option>-rf</option> <filename>/mnt/doc/lib/modules</filename></command></cmdsynopsis>

<para>Now our filesystem is ready.</para>
<para>The total size occupied by this filesystem will be about 35Mb.</para>
</sect2>
<sect2 id="rdev"><title>Step 10: Use rdev to specify the DOC root filesystem location to kernel image</title>
<para>This step is required to specify the location of the DOC root filesystem to the kernel we compiled in the step 3. The step can be avoided by giving the details of the root filesystem location in the Boot Loader configuration file, but we had some problems in making the kernel locate the root filesystem at the time of booting so we recommend executing this command:</para>
<cmdsynopsis><command>rdev <filename>/boot/vmlinuz-2.4.18 /dev/msys/fla1</filename></command></cmdsynopsis>
</sect2>
<sect2 id="lilo"><title>Step 11: Compile lilo-22.3.2</title>
<para>We are going to use LILO as the boot loader since this is the only BootLoader that can read an INFTL device without many changes to be done to the BootLoader source code.</para>
<para>For more information on how LILO and other boot loaders operate, refer to <xref linkend="booklist" />.</para>
<para>We need to compile the lilo-22-3.2 source code to get the executable file for LILO.</para>
<para>We will use the source code from <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/lilo/lilo-22.3.2</filename>.</para>
<para>Before starting the build we need to do the following:</para>
<orderedlist>
<listitem><para>Create a <emphasis>soft link</emphasis> for the kernel-2.4.18 source code with the name <filename>linux</filename>.</para>
<para>When you untar the file <filename>linux-2.4.18.tar.gz</filename> it will create a directory <filename>linux</filename>. So we need to rename the directory <filename>linux</filename> to <filename>linux-2.4.18</filename> before creating a soft link with the same name:</para>
<cmdsynopsis><command>mv <filename>linux linux-2.4.18</filename></command></cmdsynopsis>
<cmdsynopsis><command>ln <option>-s</option> <filename>linux-2.4.18 linux</filename></command></cmdsynopsis>
<para>If the above steps are not done the build might fail.</para></listitem>
<listitem><para>Patch file: <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/lilo/lilo-22.3.2/common.h</filename>:</para>


<para>The lilo-22.3.2 source code that comes with the M-Systems <filename>linux_binary.5_1_4.tgz</filename> is buggy as one of the variables <varname>PAGE_SIZE</varname> is not defined. We need to patch the LILO source code as follows:</para>

<para>Add the following lines in the <filename>common.h</filename> after the line <quote>#include .lilo.h.</quote>:</para>
<screen>
+ #ifndef PAGE_SIZE
+ #define PAGE_SIZE 4096U
+ #endif
#define 0_NACCESS 3
</screen>
<para>Where <quote>+</quote> indicates the lines to be added.</para>
</listitem>
<listitem><para>Make sure that the <command>gcc</command> version is 2.95.3 by using <command>gcc <option>--version</option></command>.</para></listitem>
</orderedlist>

<para>Now we can start the build process. Run</para>
<cmdsynopsis><command>make <parameter>clean</parameter> &amp;&amp; make</command></cmdsynopsis>
<para>This will create a new LILO executable, <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/lilo/lilo-22.3.2/lilo</filename>.  Copy this LILO executable into <filename>/sbin/lilo</filename> and <filename>/mnt/doc/sbin/lilo</filename>:</para>
<cmdsynopsis><command>cp <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/lilo/lilo-22.3.2/lilo /sbin/lilo</filename></command></cmdsynopsis>

<cmdsynopsis><command>cp <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/lilo/lilo-22.3.2/lilo /mnt/doc/sbin/lilo</filename></command></cmdsynopsis>
</sect2>
<sect2 id="boot.b"><title>Step 12: Copy the boot.b file into boot directory of DOC</title>
<para>We need to copy the file <filename>boot.b</filename> from <filename>linux_binary.5_1_4/doc-linux-5_1_4_20/lilo/</filename> to <filename>/mnt/doc/boot</filename>.</para>
<para>The file contains the essential <emphasis>stage1</emphasis> and <emphasis>stage2</emphasis> of the LILO boot loader.</para>
</sect2>
<sect2 id="liloconf"><title>Step 13:  Modify the /etc/lilo.conf file</title>
<para>First, remove the existing <filename>/etc/lilo.conf</filename>:</para>
<cmdsynopsis><command>rm <option>-rf</option> <filename>/etc/lilo.conf</filename></command></cmdsynopsis>
<para>Now create a new <filename>/etc/lilo.conf</filename>, using a text editor, and add the following lines to it:</para>
<screen>
boot=/dev/msys/fla
compact
install=/boot/boot.b
map=/boot/System.map
disk=/dev/msys/fla
bios=0x80
prompt
delay=50
timeout=50
image=/boot/vmlinuz
label=linux
root=/dev/msys/fla1
initrd=/boot/initrd.img
read-only
</screen>
<para>According to the above lines added to <filename>/etc/lilo.conf</filename>, one needs to create soft links for <filename>vmlinuz-2.4.18</filename> and <filename>initrd-2.4.18.img</filename> in <filename>/mnt/doc/boot</filename>:</para><cmdsynopsis><command>cd <filename>/mnt/doc/boot</filename></command></cmdsynopsis>
<cmdsynopsis><command>ln <option>-s</option> <filename>vmlinuz-2.4.18 vmlinuz</filename></command></cmdsynopsis>
<cmdsynopsis><command>ln <option>-s</option> <filename> initrd-2.4.18.img initrd.img</filename></command></cmdsynopsis>


<para>Copy the newly created <filename>/etc/lilo.conf</filename> to <filename>mnt/doc/etc/lilo.conf</filename>.</para>
</sect2>
<sect2 id="bootable"><title>Step 14: Store the new LILO configuration on the DiskOnChip</title>
<para>This step will configure LILO in the MBR of the DiskOnChip and hence make the DiskOnChip bootable.</para>
<para>Ensure that <filename>/dev/msys/fla1</filename> (root filesystem partition for the DOC) is mounted on the mount point <filename>/mnt/doc</filename>.</para> 
<para>Execute the following command to store the LILO configuration on the DOC:</para>

<cmdsynopsis><command>lilo<option>-v -C</option> <filename>/etc/lilo.conf</filename> <option>-r</option> <filename>/mnt/doc</filename></command></cmdsynopsis>

<para><filename>/mnt/doc</filename> denotes the location where the BootLoader will be installed, so it is installed on the DiskOnChip, as <filename>/mnt/doc</filename> is the mount point for the primary partition of DOC where LILO was configured.</para>
<para>It will create the following two files in the boot directory of DOC (i.e. <filename>/mnt/doc/boot</filename>):</para>
<orderedlist>
<listitem><para><filename>System.map-2.4.18</filename></para></listitem>
<listitem><para><filename>boot.3E00</filename></para></listitem>
</orderedlist>

<para>Now you should make a backup of the entire DiskOnChip to allow for easy restore of the files damaged by possible fatal errors:</para>

<cmdsynopsis><command>cd <filename>/home</filename></command></cmdsynopsis>
<cmdsynopsis><command>tar <option>-cvzf</option> <filename>docimg.tgz /mnt/doc</filename></command></cmdsynopsis>

<para>This will create a compressed copy of all the contents of DiskOnChip with the name <filename>docimg.tgz</filename> in <filename>/home</filename>.</para>
</sect2>
<sect2 id="fstab"><title>Step 15: Modify etc/fstab of DiskOnChip root file system</title>
<para>Open the <filename>/mnt/doc/etc/fstab</filename> file and edit the line where the mount point is <filename>/</filename>.  Change that line to:</para>
<screen>
/dev/msys/fla1  /  ext2  rw.noauto 0 1
</screen>
</sect2>
<sect2 id="firmware"><title>Step16:  Update Firmware</title>
<para>This step is required to update the firmware of the DiskOnChip. We will use the <command>dformat</command> utility from <filename>linux_binary.5_1_4/dformat_5_1_4_37</filename>:</para>

<cmdsynopsis><command>./dformat <option>-W:D000 -S:doc514.exb -Y -NOFORMAT</option></command></cmdsynopsis>

<warning><title>Don't format!</title>
<para>The <option>NOFORMAT</option> flag is important otherwise it will reformat the DiskOnChip device, and the contents will be lost.</para>
</warning>
<para>The above command will cause the DiskOnChip to boot in the absence of any other bootable device. So we need to remove the Hard Disk in order to allow the DOC to boot.</para>
</sect2>
<sect2 id="boot"><title>Step17: BOOT from DiskOnChip</title>
<para>Check your BIOS manual for enabling booting from a BIOS extension device i.e. DiskOnChip. On our system we had to disable the Hard Disk and CDROM and set the first bootable device as HDD-0.</para>
<para>Reboot the system after making the necessary changes in the BIOS.</para>
<para>You will get the LILO menu and on pressing enter Linux gets booted from DiskOnChip.</para>
</sect2>
</sect1>
<sect1 id="devtools"><title>Install Development ToolChain on DiskOnChip</title>
<para>This section may be left out if the requirement is not to have a development environment on the DiskOnChip. The following steps will install the necessary libraries and tools that are required for developing and executing programs on DiskOnChip.  This will completely eliminate the concept of having a host system and target system since now the complete application development can be done on the target system itself. For this purpose we will use uClibc which is a C library that has been developed primarily for embedded systems. Also since our root filesystem that was created in the previous section is bulky (35 MB) we will remove the unnecessary files and make it smaller, approximately 11MB.</para>
<para>We will use the Buildroot package from www.uclibc.org to replace the existing bulky root filesystem of DOC with a tiny filesystem and to install the necessary development ToolChain which includes uClibc library, gcc, g++, make, ncurses, busybox, GNU tar, GNU grep and the GNU coreutils . For more details on Buildroot refer to <ulink url="http://buildroot.uclinux.org/buildroot.html" />. The <ulink url="http://www.uclibc.org" /> website provides a precompiled package containing all the tools, which can be downloaded and used. We will use the precompiled package, which is available as <filename>root_fs</filename> image. Refer to the <ulink url="http://www.uclibc.org/FAQ.html">uClibc FAQ</ulink> for more details.</para>

<para>Follow these steps in order to get the software working on your DOS:</para>
<sect2 id="getimage"><title>Step1: Obtain the latest copy of root_fs_i386.ext2</title>
<para>Download <filename>root_fs_i386.ext2.tar.gz</filename> from <ulink url="www.uclibc.org/downloads/root_fs_i386.ext2.tar.gz" />.</para>
<para>It is around 22MB in size. This actually gets decompressed to a 100MB size file.</para>
<para>Untar the file in <filename>/usr/src</filename>:</para>
<cmdsynopsis><command>tar <option>-xvzf</option> <filename>root_fs_i386.ext2.tar.gz</filename></command></cmdsynopsis>
<para>This will create a file <filename>root_fs_i386.ext2</filename>.</para>
<para>We need to mount this file using a loopback device. Do the following steps:</para>
<cmdsynopsis><command>mkdir <filename>root_fs</filename></command></cmdsynopsis>

<cmdsynopsis><command>mount <option>-o</option> <parameter>loop</parameter> <filename>root_fs_i386.ext2 root_fs</filename></command></cmdsynopsis>

<para>Now you can access the content of the file <filename>root_fs_i386.ext2</filename> through the <filename>root_fs</filename> directory. <filename>The root_fs</filename> directory contains a number of directories which makes the root filesystem, like <filename>bin</filename>, <filename>var</filename>, <filename>sbin</filename>, <filename>opt</filename>, <filename>root</filename>, <filename>home</filename>, <filename>etc</filename>, <filename>usr</filename>, <filename>lib</filename>, <filename>tmp</filename>, <filename>dev</filename>, and <filename>proc</filename>.</para>
<para>The <filename>usr</filename> and <filename>lib</filename> directories contain the development tools like <command>gcc</command> and <command>g++</command>.</para>
</sect2>
<sect2 id="fs_swap"><title>Step2: Replace the root filesystem of the DiskOnChip</title>
<para>Replace the <filename>bin</filename>, <filename>var</filename>, <filename>sbin</filename>, <filename>etc</filename>, <filename>lib</filename>, <filename>usr</filename>, <filename>proc</filename>, <filename>mnt</filename>, <filename>home</filename> and <filename>opt</filename> directories of the DiskOnChip with the ones of the <filename>root_fs</filename> image.</para>
<warning><title>Do not replace boot and dev!</title>
<para>The <filename>boot</filename> directory of the DiskOnChip has to be kept intact since it contains the kernel image, <filename>initrd</filename> image and Map file that is used by LILO to load the kernel into memory.</para>
<para>The <filename>dev</filename> directory should also not be replaced since it contains the device nodes for DOC (The replacement task will take 5-10 minutes.)</para>
</warning>
</sect2>
<sect2 id="DOS_fstab"><title>Step3: Modify etc/fstab of DiskOnChip root file system</title>
<para>Open the newly replaced <filename>/mnt/doc/etc/fstab</filename> and edit the line where the mount point is <filename>/</filename>.  Change that line to:</para>
<screen>
/dev/msys/fla1  /  ext2  rw.noauto 0 1
</screen>
</sect2>
<sect2 id="reboot"><title>Step4: Reboot</title>
<para>Reboot from DiskOnChip and enjoy the uClibc development environment.</para>
<para>You will get the message</para>
<screen>
Welcome to the Erik.s uClibc development environment.
</screen>
<para>The entire root filesystem + boot directory + development tools take 84Mb of space.</para>
</sect2>
</sect1>
<sect1 id="refs"><title>References</title>
<para>Apart from the web sites referenced, here are some books and documents we found to be useful:</para>
<itemizedlist>
<listitem><para>Application Note: Using DiskOnChip Under Linux With M-Systems Driver,RTD Embedded Technologies Inc.,SWM-640000016A</para></listitem>
<listitem><para>Installation Manual for DiskOnChip TrueFFS driver for Linux ,M-Systems</para></listitem>
<listitem><para>Building Embedded Linux Systems, Karim Yaghmour.O.reilly,First Edition, April 2003</para></listitem>
<listitem><para>Installation Manual IM-DOC-021,Using the DiskOnChip with Linux OS,Ron Dick, Esther Spanjer, Vadim Khmelnitsky, M-Systems</para></listitem>
<listitem><para>Installation Guide available with M-Systems TrueFFS Linux driver version 5.1.4</para></listitem>
<listitem><para>Understanding the Linux Kernel, Daniel P. Bovet &amp; Marco Cesati, O.reilly, Second Edition, March 2002.</para></listitem>
<listitem><para>Booting Linux: The History and the Future, Werner Almesberger, June 25,2000</para></listitem>
</itemizedlist>
</sect1>
<appendix><title>Output of dinfo</title>
<para>The following are the details of the internals of a Linux Bootable DiskOnChip 2000 TSOP 256MB (MD2202-D256) produced by the <command>dinfo</command> utility:</para>

<figure><title>Output of dinfo</title>
<mediaobject>
<imageobject>
<imagedata fileref="images/dinfo.png" format="PNG"></imagedata>
</imageobject>
<imageobject>
<imagedata fileref="images/dinfo.eps" format="EPS"></imagedata>
</imageobject>
<textobject>
<phrase>Gneeral info about the DOS device.</phrase>
</textobject>
</mediaobject>
</figure>
<para>According to the screenshot our DOC uses an INFTL translation layer.</para>
</appendix>
<appendix><title>License</title>
<para>This document is copyrighted (c) 2006 by Rohit Agarwal &amp; Vishnu Swaminathan.</para>
<para>Permission is granted to copy, distribute and/or modify this document under the terms of the GNU Free Documentation License, Version 1.2 or any later version published by the Free Software Foundation; with no Invariant Sections, with no Front-Cover Texts, and with no Back-Cover Texts. A copy of the license is available at <ulink url="http://www.gnu.org/copyleft/fdl.html" />.</para>
</appendix>
<appendix><title>About Authors</title>
<para>Rohit Agarwal has obtained his Masters in Information Technology from IIIT-Bangalore,India and Bachelors degree in Computer Science from I.E.T. Lucknow,India.He has co-authored another HowTo "Libdc1394 Library support for IEEE1394 camera HowTo" published by TLDP in January,2006. Visit his <ulink url="htpp://geocities.com/vickys_box/rohit_agarwal.htm">homepage</ulink> for more details.</para>  
<para>Visnu Swaminathan is a PhD and MS from Duke University,North Carolina,USA. He is currently working in Siemens Corporate Technology,India</para>
<para>authors can be contacted at </para>
<para> rohdimp_24@rediffmail.com (rohit) </para>
<para> vishnu.swaminathan@siemens.com <vishnu) </para>
</appendix>
<appendix><title>Dedications</title>
<para>I am grateful to all my friends for extending their support to carry out this work. I will specially thank Vikram and Chinmaya for their valuable advices.</para>
<para>Finally I will like to dedicate this document to Mr. S.Nagarajan my professor who inspired me to contribute to Open Source Community</para>
<para> Rohit Agarwal</para>
</appendix>
</article>
